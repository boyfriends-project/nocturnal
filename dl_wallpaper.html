<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">

<!-- ãƒ•ã‚©ãƒ³ãƒˆèª­ã¿è¾¼ã¿ -->
<link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New&display=swap" rel="stylesheet">

<title>ç‰¹å…¸DLãƒšãƒ¼ã‚¸</title>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-587TGTD330"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-587TGTD330');
</script>

<meta name="viewport" content="width=device-width,initial-scale=1.0">


  <style>
    body {
      font-family: sans-serif;
      background: #ddd6fe;
      color: #4b3f72;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    h1 { margin-bottom: 20px; }
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
    }
    .gallery img {
      width: 100%;
      max-width: 200px;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .gallery img:hover {
      transform: scale(1.05);
    }
 .modal{
  display: none;              /* â† åˆæœŸã¯éè¡¨ç¤º */
  position: fixed;
  z-index: 999;
  left: 0; top: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.9);
  justify-content: center;    /* â† ã“ã“ã¯openæ™‚ã«åŠ¹ã */
  align-items: center;
  flex-direction: column;
  padding: 20px;
}
.modal.open{
  display: flex;              /* â† é–‹ãæ™‚ã ã‘è¡¨ç¤º */
}
    .modal img {
      max-width: 90%;
      max-height: 70%;
      margin-bottom: 20px;
      border-radius: 10px;
    }
    #close {
      position: absolute;
      top: 20px; right: 40px;
      font-size: 40px;
      color: #fff;
      cursor: pointer;
    }
/* æ—¢å­˜ã® #download, .dlBtn ã¸ã®ã‚¹ã‚¿ã‚¤ãƒ«ã¯ .dlBtn ã«çµ±ä¸€æ¨å¥¨ */
.dlBtn{
  appearance:none;border:0;border-radius:8px;padding:10px 14px;
  background:#c4a3ff;color:#fff;font-weight:700;text-decoration:none;
  display:inline-flex;gap:5px;align-items:center;box-shadow:0 4px 14px rgba(255,77,141,.35)
}
.dlBtn:hover{ background:#e73370; }.bulk-download{margin:14px 0 22px}
.bulk-download .dlBtn{display:inline-flex;align-items:center;gap:.5rem}

.dlBtn.disabled { pointer-events: none; opacity: .6; }

  </style>

<base href="https://boyfriends-project.github.io/nocturnal/">

</head>
<body>
  <h1>ã‚¹ãƒãƒ›ç”¨å£ç´™DLãƒšãƒ¼ã‚¸</h1>

<div class="bulk-download">
  <a id="bulk-download" class="dlBtn"
     href="images/dl/wallpapers.zip" download>
    ğŸ“¦ å£ç´™20æšã‚’ã¾ã¨ã‚ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
  </a>
</div>

  <!-- ã‚µãƒ ãƒä¸€è¦§ -->
  <div class="gallery">
    <img src="images/god/ãƒ«ãƒ“ãƒ¼ç¥.webp" data-full="images/dl/ç´…ç„”ã®æˆ¦ç¥ã‚¢ã‚°ãƒ‹ã‚ªã‚¹.webp" alt="ç¥ã•ã¾01" loading="lazy">
    <img src="images/god/ã‚»ãƒ¬ãƒŠã‚¤ãƒˆç¥.webp" data-full="images/dl/æœˆå…‰ã®å°ç¥ã‚»ãƒ¬ãƒ´ã‚£ã‚¹.webp" alt="ç¥ã•ã¾02" loading="lazy">
<img src="images/god/ã‚µãƒ•ã‚¡ã‚¤ã‚¢ç¥.webp" data-full="images/dl/å¤¢ç´¡ãã®å¹»ç¥ãƒã‚¯ãƒ†ã‚£ã‚¹.webp" alt="ç¥ã•ã¾03" loading="lazy">
    <img src="images/god/ã‚¢ãƒ³ãƒãƒ¼ç¥.webp" data-full="images/dl/æµ·çš‡ç¥ãƒŠã‚®ãƒãƒŸã‚³ãƒˆ.webp" alt="ç¥ã•ã¾04" loading="lazy">
    <img src="images/god/ã‚¬ãƒ¼ãƒãƒƒãƒˆç¥.webp" data-full="./images/dl/å¥‘ç´„ã®å†¥ç‹ã‚¿ãƒŠã‚¯ãƒªã‚¹.webp" alt="ç¥ã•ã¾05" loading="lazy">

    <img src="./images/god/ãƒ›ãƒ¯ã‚¤ãƒˆãƒ©ãƒ–ãƒ©ãƒ‰ãƒ©ã‚¤ãƒˆç¥.webp" data-full="./images/dl/å…‰è™¹ã®æ©‹ç¥ã‚°ãƒªãƒ ãƒ«ã‚¹ãƒˆ.webp" alt="ç¥ã•ã¾06" loading="lazy">
    <img src="./images/god/ãƒ©ãƒªãƒãƒ¼ç¥.webp" data-full="./images/dl/è’¼ç’°ã®å®ˆå¸ã‚¨ãƒªãƒ¥ã‚·ã‚ªãƒ³.webp" alt="ç¥ã•ã¾07" loading="lazy">

<img src="./images/god/ãƒˆãƒ‘ãƒ¼ã‚ºç¥.webp" data-full="./images/dl/é™½ç¿”ã®è–ç¥ãƒ˜ãƒªã‚ªãƒ‡ã‚£ã‚¹.webp" alt="ç¥ã•ã¾08" loading="lazy">
    <img src="./images/god/ãƒ¬ãƒƒãƒ‰ã‚³ãƒ¼ãƒ©ãƒ«ç¥.webp" data-full="./images/dl/æµ·å“­ã®å¤§ç¥å¸ã‚¸ãƒ¥ãƒ³ãƒ¦ãƒ¼.webp" alt="ç¥ã•ã¾09" loading="lazy">
    <img src="./images/god/ãƒ‘ãƒ¼ãƒ«ç¥.webp" data-full="./images/dl/å¤©ç ã®é¾ç¥ãƒ¦ãƒ³ãƒ­ãƒ³.webp" alt="ç¥ã•ã¾10" loading="lazy">

    <img src="./images/god/ã‚¢ã‚¯ã‚¢ãƒãƒªãƒ³ç¥.webp" data-full="./images/dl/æ·±ç¢§ã®å°æ˜Ÿã‚¨ãƒ‰ãƒ¯ãƒ«ãƒ‰.webp" alt="ç¥ã•ã¾11" loading="lazy">
    <img src="./images/god/ã‚¤ã‚¨ãƒ­ãƒ¼ã‚«ãƒ«ã‚µã‚¤ãƒˆç¥.webp" data-full="./images/dl/é“æ‹“ã®ç¥ã‚«ã‚¸ãƒãƒŸã‚³ãƒˆ.webp" alt="ç¥ã•ã¾12" loading="lazy">
<img src="./images/god/ã‚¤ãƒ³ã‚«ãƒ­ãƒ¼ã‚ºç¥.webp" data-full="./images/dl/ç´…èª“ã®è¦‡å°†è»ãƒã‚ªãƒ©ãƒ³.webp" alt="ç¥ã•ã¾13" loading="lazy">
    <img src="./images/god/ãƒ ãƒ¼ãƒ³ã‚¹ãƒˆãƒ¼ãƒ³ç¥.webp" data-full="./images/dl/æ˜Ÿç’°ã®æ˜Ÿç¥ã‚¢ã‚¹ãƒˆãƒªã‚ªã‚¹.webp" alt="ç¥ã•ã¾14" loading="lazy">
    <img src="./images/god/ãƒ©ãƒ”ã‚¹ãƒ©ã‚ºãƒªç¥.webp" data-full="./images/dl/è³¢ç¿¼ã®ç©ºç¥ã‚ªãƒ«ãƒ‹ã‚¯ã‚¹.webp" alt="ç¥ã•ã¾15" loading="lazy">

    <img src="./images/god/ã‚¿ã‚¤ã‚¬ãƒ¼ã‚¢ã‚¤ç¥.webp" data-full="./images/dl/è™çœ¼ã®è¦‡ç¥ãƒ¬ã‚°ãƒŠã‚¹.webp" alt="ç¥ã•ã¾16" loading="lazy">
    <img src="./images/god/ãƒ¬ãƒƒãƒ‰ã‚«ãƒ¼ãƒãƒªã‚¢ãƒ³ç¥.webp" data-full="./images/dl/å…‰éŸ¿ã®æ­Œç¥ãƒŸã‚«ãƒ…ã‚ªãƒˆ.webp" alt="ç¥ã•ã¾17" loading="lazy">

<img src="./images/god/ãƒ­ãƒƒã‚¯ã‚¯ãƒªã‚¹ã‚¿ãƒ«ç¥.webp" data-full="./images/dl/æ°·é¡ã®å¤§éœŠãƒ´ã‚§ãƒªãƒŸãƒ¼ãƒ«.webp" alt="ç¥ã•ã¾18" loading="lazy">
    <img src="./images/god/ã‚»ãƒ¬ã‚¹ã‚¿ã‚¤ãƒˆç¥.webp" data-full="./images/dl/è½Ÿå¤©ã®é›·å¸ãƒ©ã‚¤ãƒ›ã‚¦.webp" alt="ç¥ã•ã¾19" loading="lazy">
    <img src="./images/god/ã‚·ãƒˆãƒªãƒ³ç¥.webp" data-full="./images/dl/çš‡ç¥ãƒ’ã‚«ãƒªã‚«ã‚²ãƒãƒŸã‚³ãƒˆ.webp" alt="ç¥ã•ã¾20" loading="lazy">
    <!-- å¿…è¦ãªåˆ†ã ã‘è¿½åŠ  -->
  </div>
<p>â€»ã“ã®å£ç´™ã¯ã€ŒWebPå½¢å¼ã€ã§ã™ã€‚ã»ã¼ã™ã¹ã¦ã®ã‚¹ãƒãƒ›ã§é€šå¸¸ã®å£ç´™ã¨åŒã˜ã‚ˆã†ã«ä½¿ãˆã¾ã™ã€‚<br>
ã‚‚ã—å¤ã„ç«¯æœ«ã§ä½¿ãˆãªã„å ´åˆã¯ã€PNGã«å¤‰æ›ã—ã¦ãŠè©¦ã—ãã ã•ã„ã€‚</p>


  <!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="modal" class="modal">
    <span id="close">&times;</span>
    <img id="modal-img" src="" alt="">
    <a id="modal-download" class="dlBtn" href="" download>ğŸ“¥ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</a>
</div>

  <script>
  const modal = document.getElementById("modal");
  const modalImg = document.getElementById("modal-img");
  const modalDownload = document.getElementById("modal-download"); // ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã®DLãƒœã‚¿ãƒ³
  const closeBtn = document.getElementById("close");

  // æ–‡å­—åŒ–ã‘ã‚’é¿ã‘ã¦ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ä½œã‚‹
  function fileNameFrom(path, fallback="wallpaper.webp"){
    try {
      const name = decodeURIComponent(path.split('/').pop() || "");
      return name || fallback;
    } catch {
      return fallback;
    }
  }

  // 404ç°¡æ˜“ãƒã‚§ãƒƒã‚¯ï¼ˆä»»æ„ï¼‰
  async function exists(url){
    try {
      const res = await fetch(url, { method: "HEAD", cache: "no-store" });
      return res.ok;
    } catch { return false; }
  }

  // â˜…ã©ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã›ã‚‹é–¢æ•°ï¼ˆBlobçµŒç”±ï¼‰
  async function forceDownload(url, filename){
    const res = await fetch(url, { cache: "no-store" });
    if(!res.ok) throw new Error(`HTTP ${res.status}`);
    const blob = await res.blob();
    const blobUrl = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = blobUrl;
    a.download = filename;
    // iOSå¯¾ç­–ï¼šåŒã‚¿ãƒ–ã§OKã€‚æ–°è¦ã‚¿ãƒ–ãŒå¿…è¦ãªã‚‰ target="_blank" ã‚’ä»˜ã‘ã‚‹
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(blobUrl);
  }

  function openModal(previewSrc, fullSrc){
    const src = fullSrc || previewSrc;
    const safe = encodeURI(src);             // æ—¥æœ¬èªãƒ•ã‚¡ã‚¤ãƒ«åã‚’å®‰å…¨ã«
    modal.classList.add("open");
    modalImg.src = safe;

    // ãƒœã‚¿ãƒ³ã®æ—¢å®šhrefï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¨ã—ã¦æ®‹ã™ï¼‰
    modalDownload.href = safe;
    modalDownload.setAttribute("download", fileNameFrom(src));
    modalDownload.textContent = "ğŸ“¥ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰";
    modalDownload.classList.remove("disabled");

    document.body.style.overflow = "hidden";
  }

  function closeModal(){
    modal.classList.remove("open");
    modalImg.src = "";
    document.body.style.overflow = "";
  }

  // ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã®ç”»åƒã‚¯ãƒªãƒƒã‚¯ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
  document.querySelectorAll(".gallery img").forEach(img => {
    img.addEventListener("click", () => openModal(img.dataset.preview, img.dataset.full));
  });

  // âœ¨ ã“ã“ãŒé‡è¦ï¼šDLãƒœã‚¿ãƒ³ã¯å¼·åˆ¶ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
  modalDownload.addEventListener("click", async (e) => {
    // a[href]ã®æ—¢å®šé·ç§»ã‚’æ­¢ã‚ã¦ã€ç¢ºå®Ÿã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã›ã‚‹
    e.preventDefault();
    const url = modalDownload.href;
    const name = fileNameFrom(url);
    modalDownload.textContent = "â³ æº–å‚™ä¸­â€¦";
    modalDownload.classList.add("disabled");
    try {
      // å­˜åœ¨ãƒã‚§ãƒƒã‚¯ï¼ˆä»»æ„ï¼‰
      if (!(await exists(url))) throw new Error("not-found");
      await forceDownload(url, name);
      modalDownload.textContent = "âœ… ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Œäº†";
    } catch(err){
      modalDownload.textContent = "âš ï¸ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã›ã‚“";
      console.error(err);
    } finally {
      setTimeout(() => {
        modalDownload.textContent = "ğŸ“¥ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰";
        modalDownload.classList.remove("disabled");
      }, 1500);
    }
  });

  closeBtn.addEventListener("click", closeModal);
  modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });

  // --- ç’°å¢ƒæ¤œå‡º ---
  const UA = navigator.userAgent || "";
  const isLINE = /Line\//i.test(UA);                 // LINEã‚¢ãƒ—ãƒªå†…
  const isAndroid = /Android/i.test(UA);
  const isIOS = /iPhone|iPad|iPod/i.test(UA);

  // --- ãƒãƒŠãƒ¼è¡¨ç¤ºï¼ˆä»»æ„ï¼‰ ---
  if (isLINE) {
    const note = document.createElement("div");
    note.style.cssText = "background:#fff3cd;color:#664d03;border:1px solid #ffecb5;border-radius:8px;padding:10px 12px;margin:10px auto;max-width:960px;font-size:14px;";
    note.innerHTML = "LINEã‚¢ãƒ—ãƒªå†…ã§ã¯ä¿å­˜ã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚å³ä¸Šã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰<strong>å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã</strong>ã‚’é¸ã¶ã‹ã€ä¸‹ã®ãƒœã‚¿ãƒ³ã§<strong>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</strong>ã‚’ãŠè©¦ã—ãã ã•ã„ã€‚";
    document.querySelector("main")?.prepend(note);
  }

  // --- å¼·åˆ¶ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆBlobçµŒç”±ï¼‰ ---
  function fileNameFrom(path, fallback="file.bin"){
    try { return decodeURIComponent((path.split("/").pop()||"").split("?")[0]) || fallback; }
    catch { return fallback; }
  }
  async function forceDownload(url, filename){
    const res = await fetch(url, { cache: "no-store" });
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    const blob = await res.blob();
    const blobUrl = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = blobUrl;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(blobUrl);
  }

  // ã™ã¹ã¦ã®ã€Œ.dlBtnã€ã‚’å¼·åˆ¶DLã«å·®ã—æ›¿ãˆï¼ˆLINEå†…ã®ã¿ï¼‰
  if (isLINE) {
    document.querySelectorAll('a.dlBtn[href]').forEach(a => {
      a.addEventListener("click", async (e) => {
        e.preventDefault();
        const url = a.href;
        const name = fileNameFrom(url, "download");
        const origText = a.textContent;
        a.textContent = "â³ æº–å‚™ä¸­â€¦";
        a.style.pointerEvents = "none";
        try {
          await forceDownload(url, name);
          a.textContent = "âœ… ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰é–‹å§‹";
        } catch (err) {
          a.textContent = "âš ï¸ ä¿å­˜ã§ãã¾ã›ã‚“ï¼ˆå¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶æ¨å¥¨ï¼‰";
          console.error(err);
        } finally {
          setTimeout(() => {
            a.textContent = origText;
            a.style.pointerEvents = "";
          }, 1500);
        }
      }, { passive:false });
    });
  }
</script>
<p>â€»LINEã‚¢ãƒ—ãƒªå†…ã§ã¯ä¿å­˜ã§ããªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ä¸‰ç‚¹ãƒ¡ãƒ‹ãƒ¥ãƒ¼â†’å¤–éƒ¨ã€ã¾ãŸã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã‚’ãŠè©¦ã—ãã ã•ã„ã€‚</p>

<p>
  <a class="dlBtn" href="dl_music.html">Toneã®DLãƒšãƒ¼ã‚¸ã¸è¡Œã</a>
</p>
